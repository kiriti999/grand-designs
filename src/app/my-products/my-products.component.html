<section id="myProducts">
  <div class="container p-5">
    <app-message></app-message>
    <div *ngIf="!products" class="m-auto">
      <h1 class="text-center display-3 mt-5">
        <i class="fa fa-spinner fa-spin"></i>
      </h1>
    </div>
    <h3 *ngIf="products && !products.length" class="display-2 text-center mt-5">My Products is Empty</h3>
    <div *ngIf="products && products.length" class="row">
      <div class="col">
        <h4 class="display-4">My Products</h4>
        <div class="row">
          <div class="offset-10 col-2 d-none d-md-block">
            <p>
              <small class="text-muted">Price</small>
            </p>
          </div>
        </div>
        <hr class="mt-0">

        <div *ngIf="readOnlyMode">
          <div *ngFor="let product of products" class="product">
            <div class="row">
              <div class="col-4 col-md-2">
                <a routerLink="/product/{{ product.id }}">
                  <img src="{{ product.image }}" alt="image" class="img-fluid img-thumbnail">
                </a>
              </div>
              <div class="col-5 col-md-8">
                <h5>
                  <a routerLink="/product/{{ product.id }}">{{ product.title || "" }}</a>
                  <p class="m-0">
                    <small class="text-muted">{{ product.category.name }}</small>
                  </p>
                </h5>
              </div>
              <div class="col-2">
                <h6 class="font-weight-bold text-danger">{{ product.price | currency : 'INR' }}</h6>
              </div>
              <div class="col-2 mt-2">
                <button type="button" class="btn btn-sm btn-info" id="{{product.id}}"
                  (click)="getById($event)">Edit</button>
              </div>
              <div class="col-2 mt-2">
                <button type="button" class="btn btn-sm btn-info" id="{{product.id}}"
                  (click)="deleteProduct($event)">Delete</button>
              </div>
            </div>
            <hr>
          </div>
        </div>

        <div *ngIf="editOnlyMode">
          <div class="row" *ngFor="let product of products" class="product">
            <form>
              <div class="form-group">
                <label class="form-control-label">Title</label>
                <input type="text" name="title" class="form-control" [(ngModel)]="product.title">
              </div>
              <div class="form-group">
                <label class="form-control-label">Price</label>
                <input type="number" name="price" class="form-control" [(ngModel)]="product.price">
              </div>
              <div class="form-group">
                <label>Category</label>
                <select name="categoryId" [(ngModel)]="product.categoryId" class="custom-select">
                  <option *ngFor="let category of categories" [value]="category._id">
                    {{ category.name }}
                  </option>
                </select>
              </div>
              <div class="form-group">
                <label>Description</label>
                <textarea class="form-control" name="description" rows="5" [(ngModel)]="product.description"></textarea>
              </div>
              <div class="form-group">
                <label>Upload Image</label>
                <input type="file" class="form-control-file" accept="image/*" name="file" (change)="fileChange($event)">
              </div>
              <button type="button" class="btn btn-success" (click)="postChanges(product)"
                [disabled]="btnDisabled">Post</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>